"use strict";(self.webpackChunkharperdb_studio=self.webpackChunkharperdb_studio||[]).push([[803],{2717:(e,t,r)=>{r.r(t),r.d(t,{default:()=>b});var n=r(7313),o=r(238),i=r(3516),s=r(6597),a=r(1781),c=r(9327),l=r(8467),u=r(7387),p=r(7377),f=r(2190),d=r(2230),m=r(6449),y=r(6417);const b=function(){const e=(0,u.Kw)(m.Z,(e=>{var t;return null===(t=e.instances.find((e=>"local"===e.compute_stack_id)))||void 0===t?void 0:t.url})),[t,r]=(0,n.useState)({}),[b,g]=(0,n.useState)({}),[h,v]=(0,f.Z)({}),j=(0,l.s0)(),x=async()=>{r({submitted:!0});const{user:t,pass:n}=b;if(t&&n){const o=await(0,d.Z)({auth:{user:t,pass:n},url:e});o.error&&"catch"===o.type?r({error:"SSL ERROR. ACCEPT SELF-SIGNED CERT?",url:e}):o.error&&"Login failed"===o.message||"Login failed"===o.error?r({error:"Login failed. Using instance credentials?",url:"https://harperdb.io/docs/harperdb-studio/instances/#instance-login"}):o.error?r({error:o.message||o.error}):(v({...h,local:{valid:!0,user:b.user,pass:b.pass,super:o.role.permission.super_user,structure:o.role.permission.structure_user}}),setTimeout(j("/o/local/i/local/browse"),0))}else r({error:"All fields are required"})},O=e=>{"Enter"===e.code&&r({submitted:!0})};return(0,y.jsx)("div",{id:"login-form",children:t.submitted?(0,y.jsx)(p.Z,{header:"signing in",spinner:!0,relative:!0}):(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)(o.Z,{className:"mb-3",children:(0,y.jsx)(i.Z,{onKeyDown:e=>13!==e.keyCode||x(),children:(0,y.jsxs)(s.Z,{children:[(0,y.jsx)("div",{className:"instructions",children:"Please sign into HarperDB"}),(0,y.jsx)(a.Z,{id:"username",autoComplete:"username",onChange:e=>g({...b,user:e.target.value}),className:"text-center mb-1",type:"text",title:"instance user",placeholder:"instance user",value:b.user||"",disabled:t.submitted,onKeyDown:O}),(0,y.jsx)(a.Z,{id:"password",name:"password",autoComplete:"current-password",onChange:e=>g({...b,pass:e.target.value}),className:"text-center mb-2",type:"password",title:"instance password",placeholder:"instance password",disabled:t.submitted,value:b.pass||"",onKeyDown:O}),(0,y.jsx)(c.Z,{id:"signIn",onClick:x,title:"Sign In My Account",block:!0,color:"purple",disabled:t.submitted,children:"Sign In"})]})})}),t.error&&(0,y.jsxs)("a",{href:t.url||null,target:"_blank",rel:"noopener noreferrer",className:"text-bold text-center text-small text-danger d-block mt-2 text-nowrap  text-decoration-none",children:[(0,y.jsx)("span",{className:"text-danger",children:t.error}),t.url&&(0,y.jsx)("i",{className:"ms-2 fa fa-lg fa-external-link-square text-danger"})]})]})})}},3929:(e,t,r)=>{r.r(t),r.d(t,{default:()=>x});var n=r(7313),o=r(238),i=r(3516),s=r(6597),a=r(1781),c=r(9327),l=r(6782),u=r(5399),p=r(8467),f=r(2135),d=r(7387),m=r(5733),y=r(6449),b=r(6345),g=r(4757),h=r(7377),v=r(9266),j=r(6417);const x=function(){const{search:e}=(0,p.TH)(),{user:t,token:r}=m.Z.parse(e,{decode:!1}),x=(0,d.Kw)(y.Z,(e=>e.auth)),O=(0,d.Kw)(y.Z,(e=>e.theme)),[w,k]=(0,n.useState)({}),[S,R]=(0,n.useState)({}),[_,N]=(0,v.Z)({}),C=()=>{k({submitted:!0});const{email:e,pass:t}=S;(0,g.Z)(e)?t?"akamai"===O&&-1===S.email.indexOf("harperdb.io")&&-1===S.email.indexOf("akamai.com")?k({error:"portal access denied"}):(k({processing:!0}),N({..._,email:e,pass:t}),(0,b.Z)({email:e,pass:t,loggingIn:!0})):k({error:"password is required"}):k({error:"a valid email is required"})};return(0,n.useEffect)((()=>{null!==x&&void 0!==x&&x.error&&(k({error:["Unauthorized","User does not exist"].includes(x.message)?"Login Failed":x.message}),setTimeout((()=>k({})),3e3))}),[x]),(0,n.useEffect)((()=>!w.submitted&&k({})),[S]),(0,n.useEffect)((()=>{t&&r&&(0,b.Z)({email:t,pass:r,loggingIn:!0})}),[t,r]),(0,j.jsx)("div",{id:"login-form",children:w.processing?(0,j.jsx)(h.Z,{header:"signing in",spinner:!0,relative:!0}):(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)(o.Z,{className:"mb-3",children:(0,j.jsx)(i.Z,{onKeyDown:e=>13!==e.keyCode||C(),children:(0,j.jsxs)(s.Z,{children:[(0,j.jsx)("div",{className:"instructions",children:"Please sign into HarperDB Studio"}),(0,j.jsx)(a.Z,{name:"email",autoComplete:"email",id:"email",onChange:e=>{e.currentTarget.focus(),R({...S,email:e.target.value.trim().toLowerCase()})},value:S.email||"",disabled:w.submitted,className:"mb-2 text-center",type:"text",title:"email",placeholder:"email address"}),(0,j.jsx)(a.Z,{id:"password",onChange:e=>{e.currentTarget.focus(),R({...S,pass:e.target.value})},value:S.pass||"",disabled:w.submitted,className:"mb-2 text-center",type:"password",title:"password",name:"password",autoComplete:"current-password",placeholder:"password"}),(0,j.jsx)(c.Z,{id:"signIn",onClick:C,title:"Sign In My Account",block:!0,color:"purple",disabled:w.submitted,children:"Sign In"})]})})}),w.error?(0,j.jsx)("div",{className:"login-nav-link error",children:w.error}):(0,j.jsxs)(l.Z,{children:[(0,j.jsx)(u.Z,{xs:"6",children:(0,j.jsx)(f.OL,{to:"/sign-up",className:"login-nav-link",children:"Sign Up for Free"})}),(0,j.jsx)(u.Z,{xs:"6",className:"text-end",children:(0,j.jsx)(f.OL,{to:"/reset-password",className:"login-nav-link",children:"Reset Password"})})]})]})})}},2230:(e,t,r)=>{r.d(t,{Z:()=>o});var n=r(9859);const o=async e=>{let{auth:t,url:r}=e;return(0,n.Z)({operation:{operation:"user_info"},auth:t,url:r,timeout:5e3})}},9859:(e,t,r)=>{r.d(t,{Z:()=>o});var n=r(8093);const o=async e=>{let{operation:t,auth:r,url:o,timeout:i=0,authType:s,signal:a}=e;try{const e=new AbortController,u=setTimeout((()=>i?e.abort():null),i),p=await(0,n.he)(o,{signal:a||e.signal,method:"POST",body:JSON.stringify(t),headers:{"Content-Type":"application/json",authorization:"token"===s?"Bearer ".concat(r.token):"Basic ".concat(btoa("".concat(r.user,":").concat(r.pass)))}});clearTimeout(u);const f=await p.json();var c,l;return f.error?{error:!0,message:f.error,type:"response",role_errors:null===(c=f.main_permissions)||void 0===c?void 0:c.join(", "),access_errors:null===(l=f.unauthorized_access)||void 0===l?void 0:l.map((e=>{var t,r,n,o,i,s;return{schema:e.schema,table:e.table,type:null!==(t=e.required_attribute_permissions)&&void 0!==t&&t.length?"attribute":"table",entity:null!==(r=e.required_attribute_permissions)&&void 0!==r&&r.length?null===(n=e.required_attribute_permissions[0])||void 0===n?void 0:n.attribute_name:e.table,permission:null!==(o=e.required_attribute_permissions)&&void 0!==o&&o.length?null===(i=e.required_attribute_permissions[0])||void 0===i?void 0:i.required_permissions.join(", "):null===(s=e.required_table_permissions)||void 0===s?void 0:s.join(", ")}}))}:200!==p.status?{error:!0,message:"Error of type ".concat(p.status),type:"status"}:f}catch(u){return{error:!0,message:u.message,type:"catch"}}}},2190:(e,t,r)=>{r.d(t,{Z:()=>n});const n=(0,r(8131).Z)("instanceAuths")},4757:(e,t,r)=>{r.d(t,{Z:()=>n});const n=e=>/^\S+@\S+\.\S+$/.test(String(e).toLowerCase())},6597:(e,t,r)=>{r.d(t,{Z:()=>h});var n=r(7313),o=r(5192),i=r.n(o),s=r(986);function a(e){return a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a(e)}var c=["className","cssModule","tag","innerRef"];function l(){return l=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},l.apply(this,arguments)}function u(e,t){if(null==e)return{};var r,n,o=function(e,t){if(null==e)return{};var r,n,o={},i=Object.keys(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||(o[r]=e[r]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}function p(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function f(e,t){return f=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},f(e,t)}function d(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=y(e);if(t){var o=y(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return function(e,t){if(t&&("object"===a(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return m(e)}(this,r)}}function m(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function y(e){return y=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},y(e)}var b={children:i().node,tag:s.iC,innerRef:i().oneOfType([i().object,i().func,i().string]),className:i().string,cssModule:i().object},g=function(e){!function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&f(e,t)}(a,e);var t,r,o,i=d(a);function a(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(t=i.call(this,e)).getRef=t.getRef.bind(m(t)),t.submit=t.submit.bind(m(t)),t}return t=a,(r=[{key:"getRef",value:function(e){this.props.innerRef&&this.props.innerRef(e),this.ref=e}},{key:"submit",value:function(){this.ref&&this.ref.submit()}},{key:"render",value:function(){var e=this.props,t=e.className,r=e.cssModule,o=e.tag,i=void 0===o?"form":o,a=e.innerRef,p=u(e,c),f=(0,s.mx)(t,r);return n.createElement(i,l({},p,{ref:a,className:f}))}}])&&p(t.prototype,r),o&&p(t,o),Object.defineProperty(t,"prototype",{writable:!1}),a}(n.Component);g.propTypes=b;const h=g},1781:(e,t,r)=>{r.d(t,{Z:()=>j});var n=r(7313),o=r(5192),i=r.n(o),s=r(6123),a=r.n(s),c=r(986);function l(e){return l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},l(e)}var u=["className","cssModule","type","bsSize","valid","invalid","tag","addon","plaintext","innerRef"];function p(){return p=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},p.apply(this,arguments)}function f(e,t){if(null==e)return{};var r,n,o=function(e,t){if(null==e)return{};var r,n,o={},i=Object.keys(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||(o[r]=e[r]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}function d(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function m(e,t){return m=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},m(e,t)}function y(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=g(e);if(t){var o=g(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return function(e,t){if(t&&("object"===l(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return b(e)}(this,r)}}function b(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function g(e){return g=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},g(e)}var h={children:i().node,type:i().string,size:i().oneOfType([i().number,i().string]),bsSize:i().string,valid:i().bool,invalid:i().bool,tag:c.iC,innerRef:i().oneOfType([i().object,i().func,i().string]),plaintext:i().bool,addon:i().bool,className:i().string,cssModule:i().object},v=function(e){!function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&m(e,t)}(s,e);var t,r,o,i=y(s);function s(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),(t=i.call(this,e)).getRef=t.getRef.bind(b(t)),t.focus=t.focus.bind(b(t)),t}return t=s,(r=[{key:"getRef",value:function(e){this.props.innerRef&&this.props.innerRef(e),this.ref=e}},{key:"focus",value:function(){this.ref&&this.ref.focus()}},{key:"render",value:function(){var e=this.props,t=e.className,r=e.cssModule,o=e.type,i=void 0===o?"text":o,s=e.bsSize,l=e.valid,d=e.invalid,m=e.tag,y=e.addon,b=e.plaintext,g=e.innerRef,h=f(e,u),v=["switch","radio","checkbox"].indexOf(i)>-1,j="select"===i,x="range"===i,O=m||(j||"textarea"===i?i:"input"),w="form-control";b?(w="".concat(w,"-plaintext"),O=m||"input"):x?w="form-range":j?w="form-select":v&&(w=y?null:"form-check-input"),h.size&&/\D/g.test(h.size)&&((0,c.O4)('Please use the prop "bsSize" instead of the "size" to bootstrap\'s input sizing.'),s=h.size,delete h.size);var k=(0,c.mx)(a()(t,d&&"is-invalid",l&&"is-valid",!!s&&(j?"form-select-".concat(s):"form-control-".concat(s)),w),r);return("input"===O||m&&"function"===typeof m)&&(h.type="switch"===i?"checkbox":i),h.children&&!b&&"select"!==i&&"string"===typeof O&&"select"!==O&&((0,c.O4)('Input with a type of "'.concat(i,'" cannot have children. Please use "value"/"defaultValue" instead.')),delete h.children),n.createElement(O,p({},h,{ref:g,className:k,"aria-invalid":d}))}}])&&d(t.prototype,r),o&&d(t,o),Object.defineProperty(t,"prototype",{writable:!1}),s}(n.Component);v.propTypes=h;const j=v},5733:(e,t,r)=>{r.d(t,{Z:()=>N});var n={};r.r(n),r.d(n,{exclude:()=>_,extract:()=>x,parse:()=>O,parseUrl:()=>k,pick:()=>R,stringify:()=>w,stringifyUrl:()=>S});const o="%[a-f0-9]{2}",i=new RegExp("("+o+")|([^%]+?)","gi"),s=new RegExp("("+o+")+","gi");function a(e,t){try{return[decodeURIComponent(e.join(""))]}catch{}if(1===e.length)return e;t=t||1;const r=e.slice(0,t),n=e.slice(t);return Array.prototype.concat.call([],a(r),a(n))}function c(e){try{return decodeURIComponent(e)}catch{let t=e.match(i)||[];for(let r=1;r<t.length;r++)t=(e=a(t,r).join("")).match(i)||[];return e}}function l(e){if("string"!==typeof e)throw new TypeError("Expected `encodedURI` to be of type `string`, got `"+typeof e+"`");try{return decodeURIComponent(e)}catch{return function(e){const t={"%FE%FF":"\ufffd\ufffd","%FF%FE":"\ufffd\ufffd"};let r=s.exec(e);for(;r;){try{t[r[0]]=decodeURIComponent(r[0])}catch{const e=c(r[0]);e!==r[0]&&(t[r[0]]=e)}r=s.exec(e)}t["%C2"]="\ufffd";const n=Object.keys(t);for(const o of n)e=e.replace(new RegExp(o,"g"),t[o]);return e}(e)}}function u(e,t){if("string"!==typeof e||"string"!==typeof t)throw new TypeError("Expected the arguments to be of type `string`");if(""===e||""===t)return[];const r=e.indexOf(t);return-1===r?[]:[e.slice(0,r),e.slice(r+t.length)]}function p(e,t){const r={};if(Array.isArray(t))for(const n of t){const t=Object.getOwnPropertyDescriptor(e,n);null!==t&&void 0!==t&&t.enumerable&&Object.defineProperty(r,n,t)}else for(const n of Reflect.ownKeys(e)){const o=Object.getOwnPropertyDescriptor(e,n);if(o.enumerable){t(n,e[n],e)&&Object.defineProperty(r,n,o)}}return r}const f=e=>null===e||void 0===e,d=e=>encodeURIComponent(e).replace(/[!'()*]/g,(e=>"%".concat(e.charCodeAt(0).toString(16).toUpperCase()))),m=Symbol("encodeFragmentIdentifier");function y(e){if("string"!==typeof e||1!==e.length)throw new TypeError("arrayFormatSeparator must be single character string")}function b(e,t){return t.encode?t.strict?d(e):encodeURIComponent(e):e}function g(e,t){return t.decode?l(e):e}function h(e){return Array.isArray(e)?e.sort():"object"===typeof e?h(Object.keys(e)).sort(((e,t)=>Number(e)-Number(t))).map((t=>e[t])):e}function v(e){const t=e.indexOf("#");return-1!==t&&(e=e.slice(0,t)),e}function j(e,t){return t.parseNumbers&&!Number.isNaN(Number(e))&&"string"===typeof e&&""!==e.trim()?e=Number(e):!t.parseBooleans||null===e||"true"!==e.toLowerCase()&&"false"!==e.toLowerCase()||(e="true"===e.toLowerCase()),e}function x(e){const t=(e=v(e)).indexOf("?");return-1===t?"":e.slice(t+1)}function O(e,t){y((t={decode:!0,sort:!0,arrayFormat:"none",arrayFormatSeparator:",",parseNumbers:!1,parseBooleans:!1,...t}).arrayFormatSeparator);const r=function(e){let t;switch(e.arrayFormat){case"index":return(e,r,n)=>{t=/\[(\d*)]$/.exec(e),e=e.replace(/\[\d*]$/,""),t?(void 0===n[e]&&(n[e]={}),n[e][t[1]]=r):n[e]=r};case"bracket":return(e,r,n)=>{t=/(\[])$/.exec(e),e=e.replace(/\[]$/,""),t?void 0!==n[e]?n[e]=[...n[e],r]:n[e]=[r]:n[e]=r};case"colon-list-separator":return(e,r,n)=>{t=/(:list)$/.exec(e),e=e.replace(/:list$/,""),t?void 0!==n[e]?n[e]=[...n[e],r]:n[e]=[r]:n[e]=r};case"comma":case"separator":return(t,r,n)=>{const o="string"===typeof r&&r.includes(e.arrayFormatSeparator),i="string"===typeof r&&!o&&g(r,e).includes(e.arrayFormatSeparator);r=i?g(r,e):r;const s=o||i?r.split(e.arrayFormatSeparator).map((t=>g(t,e))):null===r?r:g(r,e);n[t]=s};case"bracket-separator":return(t,r,n)=>{const o=/(\[])$/.test(t);if(t=t.replace(/\[]$/,""),!o)return void(n[t]=r?g(r,e):r);const i=null===r?[]:r.split(e.arrayFormatSeparator).map((t=>g(t,e)));void 0!==n[t]?n[t]=[...n[t],...i]:n[t]=i};default:return(e,t,r)=>{void 0!==r[e]?r[e]=[...[r[e]].flat(),t]:r[e]=t}}}(t),n=Object.create(null);if("string"!==typeof e)return n;if(!(e=e.trim().replace(/^[?#&]/,"")))return n;for(const o of e.split("&")){if(""===o)continue;const e=t.decode?o.replace(/\+/g," "):o;let[i,s]=u(e,"=");void 0===i&&(i=e),s=void 0===s?null:["comma","separator","bracket-separator"].includes(t.arrayFormat)?s:g(s,t),r(g(i,t),s,n)}for(const[o,i]of Object.entries(n))if("object"===typeof i&&null!==i)for(const[e,r]of Object.entries(i))i[e]=j(r,t);else n[o]=j(i,t);return!1===t.sort?n:(!0===t.sort?Object.keys(n).sort():Object.keys(n).sort(t.sort)).reduce(((e,t)=>{const r=n[t];return Boolean(r)&&"object"===typeof r&&!Array.isArray(r)?e[t]=h(r):e[t]=r,e}),Object.create(null))}function w(e,t){if(!e)return"";y((t={encode:!0,strict:!0,arrayFormat:"none",arrayFormatSeparator:",",...t}).arrayFormatSeparator);const r=r=>t.skipNull&&f(e[r])||t.skipEmptyString&&""===e[r],n=function(e){switch(e.arrayFormat){case"index":return t=>(r,n)=>{const o=r.length;return void 0===n||e.skipNull&&null===n||e.skipEmptyString&&""===n?r:null===n?[...r,[b(t,e),"[",o,"]"].join("")]:[...r,[b(t,e),"[",b(o,e),"]=",b(n,e)].join("")]};case"bracket":return t=>(r,n)=>void 0===n||e.skipNull&&null===n||e.skipEmptyString&&""===n?r:null===n?[...r,[b(t,e),"[]"].join("")]:[...r,[b(t,e),"[]=",b(n,e)].join("")];case"colon-list-separator":return t=>(r,n)=>void 0===n||e.skipNull&&null===n||e.skipEmptyString&&""===n?r:null===n?[...r,[b(t,e),":list="].join("")]:[...r,[b(t,e),":list=",b(n,e)].join("")];case"comma":case"separator":case"bracket-separator":{const t="bracket-separator"===e.arrayFormat?"[]=":"=";return r=>(n,o)=>void 0===o||e.skipNull&&null===o||e.skipEmptyString&&""===o?n:(o=null===o?"":o,0===n.length?[[b(r,e),t,b(o,e)].join("")]:[[n,b(o,e)].join(e.arrayFormatSeparator)])}default:return t=>(r,n)=>void 0===n||e.skipNull&&null===n||e.skipEmptyString&&""===n?r:null===n?[...r,b(t,e)]:[...r,[b(t,e),"=",b(n,e)].join("")]}}(t),o={};for(const[s,a]of Object.entries(e))r(s)||(o[s]=a);const i=Object.keys(o);return!1!==t.sort&&i.sort(t.sort),i.map((r=>{const o=e[r];return void 0===o?"":null===o?b(r,t):Array.isArray(o)?0===o.length&&"bracket-separator"===t.arrayFormat?b(r,t)+"[]":o.reduce(n(r),[]).join("&"):b(r,t)+"="+b(o,t)})).filter((e=>e.length>0)).join("&")}function k(e,t){var r,n;t={decode:!0,...t};let[o,i]=u(e,"#");return void 0===o&&(o=e),{url:null!==(r=null===(n=o)||void 0===n||null===(n=n.split("?"))||void 0===n?void 0:n[0])&&void 0!==r?r:"",query:O(x(e),t),...t&&t.parseFragmentIdentifier&&i?{fragmentIdentifier:g(i,t)}:{}}}function S(e,t){t={encode:!0,strict:!0,[m]:!0,...t};const r=v(e.url).split("?")[0]||"";let n=w({...O(x(e.url),{sort:!1}),...e.query},t);n&&(n="?".concat(n));let o=function(e){let t="";const r=e.indexOf("#");return-1!==r&&(t=e.slice(r)),t}(e.url);if(e.fragmentIdentifier){const n=new URL(r);n.hash=e.fragmentIdentifier,o=t[m]?n.hash:"#".concat(e.fragmentIdentifier)}return"".concat(r).concat(n).concat(o)}function R(e,t,r){r={parseFragmentIdentifier:!0,[m]:!1,...r};const{url:n,query:o,fragmentIdentifier:i}=k(e,r);return S({url:n,query:p(o,t),fragmentIdentifier:i},r)}function _(e,t,r){return R(e,Array.isArray(t)?e=>!t.includes(e):(e,r)=>!t(e,r),r)}const N=n}}]);