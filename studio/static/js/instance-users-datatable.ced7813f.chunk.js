"use strict";(self.webpackChunkharperdb_studio=self.webpackChunkharperdb_studio||[]).push([[196],{8351:(e,a,s)=>{s.r(a),s.d(a,{default:()=>N});var t=s(7313),n=s(6782),r=s(5399),l=s(9327),i=s(238),o=s(3516),c=s(7387),d=s(8467),g=s(9842),u=s(5447),m=s(2066),h=s(4220),p=s(2261),x=s(6855),j=s(6417);const f={tableData:[],dataTableColumns:[],totalRecords:0,filtered:[],sorted:[{id:"username",desc:!1}],page:0,loading:!1,totalPages:1,pageSize:20,autoRefresh:!1,showFilter:!1,lastUpdate:!1};let v;const N=function(e){var a,s;let{lastUpdate:N,setLastUpdate:b}=e;const{customer_id:C}=(0,d.UO)(),Z=(0,d.s0)(),P=(0,c.Kw)(u.Z,(e=>e.compute_stack_id)),w=(0,c.Kw)(u.Z,(e=>e.auth)),S=(0,c.Kw)(u.Z,(e=>e.url)),[k,z]=(0,t.useState)(f),[F,y]=(0,t.useState)(!0),R=null===(a=k.sorted[0])||void 0===a?void 0:a.id,O=null===(s=k.sorted[0])||void 0===s?void 0:s.desc,E=(0,t.useCallback)((e=>{Z("/o/".concat(C,"/i/").concat(P,"/users/").concat(e))}),[P,C]);return(0,t.useEffect)((()=>{let e=!0;return w&&(async()=>{y(!0),v=new AbortController;const a=await(0,m.Z)({auth:w,url:S,signal:v.signal});e&&(y(!1),z({...k,tableData:a,dataTableColumns:[{Header:"username",accessor:"username"},{Header:"role",accessor:"role"}],totalPages:Math.ceil((a.length||k.pageSize)/k.pageSize),loading:!1}))})(),()=>{var a;e=!1,null===(a=v)||void 0===a||a.abort()}}),[w,N,k.pageSize]),(0,t.useEffect)((()=>{let e=!0;if(k.tableData.length&&R){const a=[...[...k.tableData]].sort(((e,a)=>e[R]>a[R]&&O?1:e[R]>a[R]||O?-1:1));e&&z({...k,tableData:a})}return()=>{var a;e=!1,null===(a=v)||void 0===a||a.abort()}}),[R,O]),(0,j.jsxs)(g.SV,{onError:(e,a)=>(0,p.Z)({error:{message:e.message,componentStack:a}}),FallbackComponent:h.Z,children:[(0,j.jsxs)(n.Z,{className:"floating-card-header",children:[(0,j.jsx)(r.Z,{children:"existing users"}),(0,j.jsxs)(r.Z,{className:"text-end",children:[(0,j.jsx)(l.Z,{color:"link",onClick:()=>b(Date.now()),className:"me-2",children:(0,j.jsx)("i",{title:"Refresh Structure",className:"fa ".concat(F?"fa-spinner fa-spin":"fa-sync-alt")})}),(0,j.jsx)("span",{className:"mx-3 text",children:"|"}),(0,j.jsx)(l.Z,{color:"link",title:"Filter Users",className:"me-2",onClick:()=>z({...k,filtered:k.showFilter?[]:k.filtered,showFilter:!k.showFilter}),children:(0,j.jsx)("i",{className:"fa fa-search"})})]})]}),(0,j.jsx)(i.Z,{className:"mt-3",children:(0,j.jsx)(o.Z,{className:"react-table-holder",children:(0,j.jsx)(x.Z,{columns:k.dataTableColumns,data:k.tableData,currentPage:k.page,pageSize:k.pageSize,totalPages:k.totalPages,showFilter:k.showFilter,sorted:k.sorted,loading:F,onFilteredChange:e=>z({...k,filtered:e}),onSortedChange:e=>z({...k,sorted:e}),onPageChange:e=>z({...k,pageSize:e}),onPageSizeChange:e=>z({...k,page:0,pageSize:e}),onRowClick:e=>E(e.username)})})})]})}},6855:(e,a,s)=>{s.d(a,{Z:()=>N});var t=s(7313),n=s(5110),r=s(1781),l=s(9842),i=s(6782),o=s(5399),c=s(6417);const d=e=>{let{headerGroups:a,onSortedChange:s,sorted:t,showFilter:n}=e;return a.map((e=>(0,c.jsxs)("div",{...e.getHeaderGroupProps(),children:[(0,c.jsx)(i.Z,{className:"header g-0",children:e.headers.map((e=>{var a,n;return(0,c.jsx)(o.Z,{onClick:()=>{var a,n;return s([{id:e.id,desc:(null===(a=t[0])||void 0===a?void 0:a.id)===e.id&&!(null!==(n=t[0])&&void 0!==n&&n.desc)}])},className:"".concat((null===(a=t[0])||void 0===a?void 0:a.id)===e.id?"sorted":""," ").concat(null!==(n=t[0])&&void 0!==n&&n.desc?"desc":"asc"," ").concat(-1!==e.id.indexOf("hdb-narrow")?"action":""," px-1"),children:(0,c.jsx)("div",{className:"text-renderer",children:e.render("Header")})},e.id)}))}),n&&(0,c.jsx)(i.Z,{className:"filter g-0",children:e.headers.map((e=>(0,c.jsx)(o.Z,{className:-1!==e.id.indexOf("hdb-narrow")?"action":"",children:e.render("Filter")},e.id)))})]})))};var g=s(9327);const u=function(e){let{page:a,pageSize:s,totalPages:t,onPageChange:n,onPageSizeChange:l,loading:d}=e;return(0,c.jsxs)(i.Z,{className:"pagination",children:[(0,c.jsx)(o.Z,{xs:"12",sm:"2",className:"previous",children:(0,c.jsx)(g.Z,{className:"mb-2 btn-pagination",color:"purple",block:!0,onClick:()=>n(a-1),disabled:!t||0===a,children:(0,c.jsx)("i",{className:"fa fa-chevron-left"})})}),(0,c.jsxs)(o.Z,{xs:"12",sm:"4",className:"paginator",children:[(0,c.jsx)("i",{className:"fa fa-book me-2"}),(0,c.jsx)(r.Z,{className:"mb-2",type:"number",value:a+1,min:1,max:t,onChange:e=>n(e.target.value-1)}),(0,c.jsxs)("div",{className:"page-count",children:["\xa0/\xa0",d?(0,c.jsx)("i",{className:"fa fa-spinner fa-spin"}):t]})]}),(0,c.jsx)(o.Z,{xs:"12",sm:"4",className:"page-size",children:(0,c.jsx)(r.Z,{className:"mb-2",type:"select",value:s,onChange:e=>l(e.target.value),children:[20,50,100,250].map((e=>(0,c.jsxs)("option",{value:e,children:[e," rows"]},e)))})}),(0,c.jsx)(o.Z,{xs:"12",sm:"2",className:"next",children:(0,c.jsx)(g.Z,{className:"mb-2 pull-right btn-pagination",block:!0,color:"purple",onClick:()=>n(a+1),disabled:!t||a+1===t,children:(0,c.jsx)("i",{className:"fa fa-chevron-right"})})})]})};const m=function(e){let{previousPage:a,canPreviousPage:s,pageIndex:t,gotoPage:n,setPageSize:l,pageCount:d,nextPage:u,canNextPage:m,loading:h}=e;return(0,c.jsxs)(i.Z,{className:"pagination",children:[(0,c.jsx)(o.Z,{xs:"12",sm:"2",className:"previous",children:(0,c.jsx)(g.Z,{className:"mb-2 btn-pagination",color:"purple",block:!0,onClick:a,disabled:!d||!s,children:(0,c.jsx)("i",{className:"fa fa-chevron-left"})})}),(0,c.jsxs)(o.Z,{xs:"12",sm:"4",className:"paginator",children:[(0,c.jsx)("i",{className:"fa fa-book me-2"}),(0,c.jsx)(r.Z,{className:"mb-2",type:"number",value:t+1||1,min:1,max:d,onChange:e=>n(e.target.value?Number(e.target.value)-1:0)}),(0,c.jsxs)("div",{className:"page-count",children:["\xa0/\xa0",h?(0,c.jsx)("i",{className:"fa fa-spinner fa-spin"}):d]})]}),(0,c.jsx)(o.Z,{xs:"12",sm:"4",className:"page-size",children:(0,c.jsx)(r.Z,{className:"mb-2",type:"select",onChange:e=>{n(0),setTimeout((()=>l(e.target.value)),1e3)},children:[20,50,100,250].map((e=>(0,c.jsxs)("option",{value:e,children:[e," rows"]},e)))})}),(0,c.jsx)(o.Z,{xs:"12",sm:"2",className:"next",children:(0,c.jsx)(g.Z,{className:"mb-2 pull-right btn-pagination",block:!0,color:"purple",onClick:u,disabled:!d||!m,children:(0,c.jsx)("i",{className:"fa fa-chevron-right"})})})]})};const h=function(e){let{prepareRow:a,row:s,onRowClick:t=!1}=e;return a(s),(0,c.jsx)(i.Z,{onClick:()=>t&&t(s.original),className:"g-0",children:s.cells.map((e=>(0,c.jsx)(o.Z,{className:-1!==e.column.id.indexOf("hdb-narrow")?"action":"",children:e.render("Cell")},"".concat(e.row.id,"-").concat(e.column.id))))})};var p=s(2261),x=s(4220);function j(e){let{value:a}=e;return(0,c.jsx)("div",{className:"text-renderer",children:a})}function f(e){let{src:a}=e;const[s,n]=(0,t.useState)(!1),[r,l]=(0,t.useState)(!1);return(0,c.jsxs)("div",{className:"image-renderer",onMouseEnter:()=>n(!0),onMouseLeave:()=>n(!1),children:[(0,c.jsx)("i",{className:"fa fa-image"}),s&&r?(0,c.jsxs)("div",{className:"preview-image no-image",children:[(0,c.jsx)("i",{className:"fa fa-ban text-danger"}),(0,c.jsx)("div",{className:"mt-2",children:"image failed to load"})]}):s?(0,c.jsx)("img",{onError:l,alt:a,src:a,className:"preview-image"}):null]})}const v={Filter:e=>{let{column:{filterValue:a,setFilter:s}}=e;return(0,c.jsx)(r.Z,{type:"text",value:a||"",onChange:e=>s(e.target.value||void 0)})},Cell:e=>{let{value:a}=e;return(e=>{switch(Object.prototype.toString.call(e)){case"[object Array]":case"[object Object]":return(0,c.jsx)(j,{value:JSON.stringify(e)});case"[object Boolean]":return(0,c.jsx)(j,{value:e?"true":"false"});case"[object String]":return(a=e)&&(a.match(/^https?.*\.(jpeg|jpg|gif|png)$/)||-1!==a.indexOf("data:image"))?(0,c.jsx)(f,{src:e}):(0,c.jsx)(j,{value:e});default:return(0,c.jsx)(j,{value:e})}var a})(a)}};const N=function(e){let{columns:a,data:s,currentPage:r,pageSize:i,totalPages:o,onFilteredChange:g,onSortedChange:j,onPageChange:f,onPageSizeChange:N,showFilter:b,onRowClick:C,sorted:Z,loading:P,manual:w=!1}=e;const{headerGroups:S,page:k,rows:z,prepareRow:F,state:y,setAllFilters:R,canPreviousPage:O,canNextPage:E,pageOptions:D,pageCount:T,gotoPage:_,nextPage:A,previousPage:U,setPageSize:G}=(0,n.useTable)({columns:a,data:s,defaultColumn:v,onFilteredChange:g,onSortedChange:j,onPageChange:f,onPageSizeChange:N,onRowClick:C,manualPagination:w,manualFilters:w,initialState:{pageIndex:r,pageSize:i}},n.useFilters,n.usePagination),[H,I]=(0,t.useState)(!0),L=w||!k.length?z:k;return(0,t.useEffect)((()=>{!b&&y.filters.length?R([]):g(y.filters)}),[y.filters,b]),(0,t.useEffect)((()=>{setTimeout((()=>I(!1)),100)}),[null===L||void 0===L?void 0:L.length]),(0,c.jsxs)(l.SV,{onError:(e,a)=>(0,p.Z)({error:{message:e.message,componentStack:a}}),FallbackComponent:x.Z,children:[(0,c.jsxs)("div",{className:"react-table-scroller",children:[(0,c.jsx)(d,{headerGroups:S,onSortedChange:j,sorted:Z,showFilter:b}),P||H?(0,c.jsx)("div",{className:"centered text-center",children:(0,c.jsx)("i",{className:"fa fa-spinner fa-spin"})}):L.length?L.map((e=>(0,c.jsx)(h,{row:e,prepareRow:F,onRowClick:C},e.id))):(0,c.jsxs)("div",{className:"centered text-center",children:[(0,c.jsx)("i",{className:"fa fa-exclamation-triangle text-danger"}),(0,c.jsx)("div",{className:"mt-2 text-darkgrey",children:"no records"})]})]}),w?(0,c.jsx)(u,{page:r,pageSize:i,totalPages:o,onPageChange:f,onPageSizeChange:N,loading:P}):(0,c.jsx)(m,{previousPage:U,pageSize:i,canPreviousPage:O,pageIndex:y.pageIndex,pageOptions:D,gotoPage:_,setPageSize:G,pageCount:T,nextPage:A,canNextPage:E,loading:P})]})}},2066:(e,a,s)=>{s.d(a,{Z:()=>r});var t=s(9859),n=s(5447);const r=async e=>{let{auth:a,url:s,signal:r}=e;const l=await(0,t.Z)({operation:{operation:"list_users"},auth:a,url:s,signal:r}),i=Array.isArray(l)?[...l].map((e=>({username:e.username,role:e.role.role}))).sort(((e,a)=>e.username.toLowerCase()>a.username.toLowerCase()?1:-1)):[];return n.Z.update((e=>{e.users=i})),i}}}]);